PROGRAM TONFIL
REAL K,L,HU,NP,KSI1,KSI2,KK
INTEGER VID
DIMENSION DT(7) ,DSHT(9)
DATA DT/0.15,0.25,0.35,0.42,0.5,0.6,0.8/
DATA DSHT/0.625,0.05,0.08,0.1,0.15,0.2,0.25,0.9,0.4/
WRITE(S,*)"hB "Wee hB HARB BN
OPEN (UNIT=2,FILE="TONFIL.DAT" ,STATUS="OLD"
OPEN (UNIT=3,FILE=" INPUT .BAS" ,STATUS="NEW"
OPEN (UNIT=1,FILE="UFIL.BAS" STATUS="NEW")
READ (2,3) VID
READ (2,1) GMAX,P,T,K,DN,L,DELTP,MU,ROJ,DELTPF
PI=9.1415926
IF (ID.EQ.8) WRITE(5,5)
IF (VID.EQ.6) GO TO 108 I
READ (2,4) NZAD,DHZAD
WRITE(5 6)
400 F=PIxDN=L*19000.
- 06*K*DELTPAF*ROJ/HU
HAX/OP
IF (VID.NE.@.AND.NP.GT.NZAD) WRITE(1,9)
IF (VID-EQ.8) GO TO 1213
co To 1313
4213 IF (NP.LE.1.)
IF (NP.GT.1.AND.NP.LE.3.)
IF (NP.GT.3-AND.NP.LE.7.)
IF (NP.GT.7-AND.NP.LE.10.)
IF (NP.GT.10.8ND.NP.LE.16.)
IF (NP.GT.16.AND-NP.LE.23.)
IF (NP.GT.23.AND-NP.LE.41.)
IF(NP.LE-41.) GO TO 1313
WRITE (1,71)
STOP
1913 IF (VID.NE.6) N=NZAD
IF (N.LE.1) D=DT(1)
IF (N.GT.1.AND.N.LE.3)
IF (N.GT.3.AND.N.LE.7)
IF (N.GT.7-AND.N.LE.10)
IF (H.GT.10.AND.N.LE.16) D=DT(5)
IF (H.GT.16.AND-N.LE.23) D=DT(6)
IF (H.GT.23-AND-N-LE.41) D=DT(7)
IF(N.LE.41) 60 TO 38
WRITE (1,91)
WRITE (1,71)
STOP
30 Q=GHAK/N
TF (Q.6T.QP) WRITE(1,21)
WuD0P=2.6
DSHP=1.13%SQRT (GMAX/(WJDOP#3600.*R0J))
IF (VID.NE.@.AND.DSHP.GT.DHZAD) WRITE (1,8)
IF(VID.NE.8) 60 TO 16
Do 32 1=1,9
IF (DSHT(I)-LT.DSHP) 60 TO 32
DSH=DSHT(I)
co To 34
32 CONTINUE
WRITE (1,33)
38° FORMAT(SX,*,0Wh..’h W'"-..hb ,tRyb (,>°K 5) $B JAR' H,*
SK, WB KOZ PROM. Kb MBBCORRCR “BE CM-RRCH)
STOP
461 DSH=DHZAD
24 IF (DSH.GT.6.5%D) WRITE(1,22)
WID=GMAX/(0.785*3600.*ROJ*DSH%X2. )

KSI2=0.5

DEPSH=(KSI4+KS12) *(WJD%%2..)*ROJ/(2.*9.81%1 00000.)
DEPD=QxHU/ (8. 86%K*F*ROJ)
IF (DEPD.GT.DELTP) WRITE (1,15)

DELPF=ALF*(DEPSH+DEPD)
KK=2.
IF (KK*DELPF.GE.DELTPF) WRITE(1,23)
CALL IS(GMAX,P,T,K,DN,L,DELTP,MU,ROJ,DELTPF,
* NZAD,DHZAD, VID)
CALL UYH(VID,GMAX,QP,Q,F,NP,N,D,
%* DSH, WJD,DEPSH, DEPD , DELPF) I
91 FORMAT(SX, "0h." BUUBHE SK. sofhbe y Wt bun")
a FORMAT(SX, BRCM...” “yh "MCh HTM UB ‘HER, PRcwm. 41"
FORMAT(F10.2,F6.2,F5.1,F7.4,2F6.3,F5.3,F7.5,F7.2,F6.4)
FORMAT(11)
FORMAT(13,F5.3)
FORMAT(SX,* , >Uhci
FORMAT(SX,* , >UR«K
FORMAT(5X, “RI.
RY MB)
8 FORMAT(SX,*,,NBh..'h W'°-hB y°Fygb (,2+hob) HSER, */
SK, HB KOZ PRUE. £B,BRERER )
9 FORMAT(SX, “HB-B. (RH. ”
* 5X, Phcwl. £8,,BRERER )
45 FORMAT(5X, °K.

Sy UbRb 1% QB
“y UR RO HB?
Fb aH. R.. RUBR <ul

“Ew HWW UB HBR, 7

SRS UBHREE PRcw. RU RARER. FMA Ul
* 5X," FURR’ RR UB “RKB )

21 FORMAT(5x," oy
SX, UNRUE (Fa ca we UB BRR ay
5X, PRwML. BBY. RRZ")

22 EORNAT CSE,“ ) WHE Toth (o2-Tsh) HRLAH HC/ I
* SN," PRwML. URCH,IK> ,ATh.."bB BUUBHD "B')

28° FORMAT(SX, 4." °c ARB UR. OR. RUHR cL
SK, ORER "Wem PRM, UB by cal’ 7
5X, Nah.)

CLOSE (2)

CLOSE (3)

CLOSE (1)

WRITE (,) BIC hud" ch 'B"R, DBS
VRITEG#)*) ("REC UbWbA” “RG by
VRITE(*,») * hb '.? EHR
STOP

END

- INPUT.BAS*
<B'R, - UFIL.BAS*

SUBROUTINE IS(GMAX,P,T,K,DN,L,DELTP,HU,ROJ,DELTPF,
% NZAD,DHZAD,VID)
REAL K,L,HU
INTEGER VID
WRITE (3,1)
IF (VID.NE.6) WRITE(3,2)
IF (VID.EQ.6) WRITE(3,3)
WRITE(3,4) GMAX
WRITE(3,5) P
WRITE(3,6) T
WRITE(3,7) K I
WRITE(3,22) DM
WRITE(3,28) L
WRITE(3,9) DELTP
WRITE(3,21) HU
WRITE(3,8) ROJ
WRITE(3,25) DELTPF
IF (VID.NE.6) WRITE (3,14) NZAD
IF (VID.NE.6) WRITE (3,16) DHZAD
1 FORMAT(//15%,* ace RBCRFM A BAEZ BS
BB BRR, BWP RN ////25%,°3. BRR. cy BB
2 FORMAT(25X,",B,, HB '—."B — URaReR>Z 7)
3 FORMAT(25X,",, HB-B — UbRsh'R>% */)
ny FORMAT (SX, “URIS ,F8.c6K Bh UB HN SOBS 7
5X," BB MMO Ey, MF /—",27X,F11.2)
5 FORMAT (SX, 9B, <ulRBL. HBR nny HEED BRR, YB! 517K F7.2)
FORMAT (SH -AU-HB “YB HBF FHys fn, 6°. 28x FO 1)
FORMAT(SX, BR" "M-W.R’ UBB) -WBKBCORE H" ,19X,F8 4
FORMAT (SX, "UCR RR’ ‘i BJU’ My Sor 73" ,24X,F8.2)
FORMAT (SX, FH,HB, AR. WR. RUB, cul. BEB
* 5X," UB RRB, HB! ,38X,F6.3) J
11 FORMAT(SX, RCH. 7B MH UBHBRR, , 18X14
18 FORMAT(S,* NBM.’ MW!" -aN y-Rsb (,>-RyB) $bsih’ MW, th’ ,8X,F7.3)
22 FORMAT(SX, "KBH"#4>% NB.’ UB'DRKB, th" ,23%,F7.3)
28 FORMAT (Si, CMG UB ARK, 94% F 7.2)
21 FORMAT(SX, WRB’ RHE. Cy EB
* 1 FARE, UBC" 1X, F8-5)
25 FORMAT(SX, “RY “M2 Uh
"MG ho, UB! 78, F724)
RETURN
END

BN)

UB,, 5b, <Kly KB",

SUBROUTINE UYH (VID, CHAX,QP,Q,F,NP,N,D,DSH,WJD,DEPSH,
* DEPD,DELPF)
REAL NP
INTEGER VID
WRITE(3,1) QP
WRITE(3,50) 0
WRITE(3,3) F
WRITE(3,4) NP
IF(VID-EQ.6) — WRITE(3,51)
WRITE(3,6) D
IF(VID.EQ.8) — WRITE(3,18) DSH
WRITE(3,11) MUD
WRITE(3,13) DEPSH
WRITE(3,12) DEPD
WRITE(3,14) DELPF
WRITE(3,20) DN
WRITE(3,2) DELPF ,GMAX
1 FORNAT(//248-°4. Ho ch > WB B17
* SX, UDREE, ROR BARAK “Cw 'h WR UB HRB:

* 8X," WB'-.'kby, fh 7—*,28%,F10.1)
50 FORMAT(8X," ,,..c°’,M'..<iK(by, fhe /-" ,23K,F10.1)
3 FORMAT(SX,°UR,.up-KB* ‘i “Mie hB-MN UB 'HRAB, “Hee#2" ,12K,F8.0
4 FORMAT (SX, CH." "4% “Wcib’h° HS UB 'DRRB, = °/
© BX,1 HB. 'MR., 935%, F541)
51 FORMAT(8X,* yy." W'..ctbiR, H'*431X, 14)
6 FORMAT (SX, *,,NBh..'h “WKw'hB, Hh" ,S4X,F5.2)
10 © FORMAT(5X, "0h." H'"-..pb 4°Ryb (2°85) HBJiR' 'M, th" 8X,F7.3)
41 FORMAT(5X," “RR “wm tHLJh’ my 2tBaB
* ' GoeTyb), Ibs ** 4X F6.2)
420 FORMAT(SX, "0° 8.<OKR. FAB RR. BURR, <All
* SX,1 -I RR UB HBG, HUB ,28X,F8.5)
138 FORMAT(5X,"#1,.pB, BR. BURMA.) W-bBe */
* SK," ys Reb Co-Fyb) fJih’ M, MB" ,26X,F8.5)
44 FORMAT(5X,"71,.yb,.. R.. “BURN, <. wR
* 5X," “Ikw’hb, IUB" ,36X,F8.5)
26 FORMAT(///30X, “#WoCR-RML. *7//10X, "15 KR, BME,
OT Ub Ror RRER ‘ue RCREN. MBER WB! ~~. 1b*/1 8X,
= KB EB BAG. CRM UbMKy “BK hs,
= ' HUGRZ B- *4F5.2,° th Ml fc :
1 Hew RHE /10X, “UR HRKR, "13, *
2 FORMAT(10X,"/0,bB, cH." BR.. BURN, RR
* 10K," "Hw HB" WF8.5,
0X, RE CORy "BRB Mas BM 20 Wh /
% 10X,* BRM by BK’ ya My Yam Tn” BS MBC /
* 10X, URNS, BW '..cwKR “UR SLSR WM JFA1.2,° F/-")
RETURN
END